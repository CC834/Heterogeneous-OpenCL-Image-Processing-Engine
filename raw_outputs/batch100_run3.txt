========== SPLIT-IMAGE CONFIGURATION ==========
Input file: ./image_320x240.jpg
Number of images in stream: 5000
Batch size: 100 images
Number of batches: 50
Work-group size: 16x16
GPU ratio: 59.7% (rows to GPU)
Halo size: 1 row(s)
================================================

Original image loaded: 320x240, 3 channels
Size of one image: 230400 bytes (225.00 KB)
Original image converted to interleaved format

Split configuration:
  Split row: 96 (CPU: rows 0-95, GPU: rows 96-239)
  CPU: 97 input rows (inc. halo), 96 output rows
  GPU: 145 input rows (inc. halo), 144 output rows
  CPU input size: 90.94 KB, output size: 90.00 KB
  GPU input size: 135.94 KB, output size: 135.00 KB

Platform 0: rusticl
Platform 1: Portable Computing Language
CPU device: cpu-skylake-avx512-AMD Ryzen AI 7 350 w/ Radeon 860M
GPU device: AMD Radeon 860M Graphics (radeonsi, gfx1152, LLVM 20.1.8, DRM 3.64, 6.16.12-200.fc42.x86_64)

Loading kernel source...
Kernel source loaded (2054 bytes)
Building kernel for CPU...
CPU kernel built successfully
Building kernel for GPU...
GPU kernel built successfully
Kernel objects created

Allocating device buffers...
Device buffers allocated

Setting kernel arguments...
Kernel arguments set

CPU global size: 320 x 112
GPU global size: 320 x 160
Local size: 16 x 16

Starting batch processing of 5000 images in 50 batches...

=== Processing Batch 1/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 1 complete.

=== Processing Batch 2/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 2 complete.

=== Processing Batch 3/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 3 complete.

=== Processing Batch 4/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 4 complete.

=== Processing Batch 5/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 5 complete.

=== Processing Batch 6/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 6 complete.

=== Processing Batch 7/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 7 complete.

=== Processing Batch 8/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 8 complete.

=== Processing Batch 9/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 9 complete.

=== Processing Batch 10/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 10 complete.

=== Processing Batch 11/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 11 complete.

=== Processing Batch 12/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 12 complete.

=== Processing Batch 13/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 13 complete.

=== Processing Batch 14/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 14 complete.

=== Processing Batch 15/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 15 complete.

=== Processing Batch 16/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 16 complete.

=== Processing Batch 17/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 17 complete.

=== Processing Batch 18/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 18 complete.

=== Processing Batch 19/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 19 complete.

=== Processing Batch 20/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 20 complete.

=== Processing Batch 21/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 21 complete.

=== Processing Batch 22/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 22 complete.

=== Processing Batch 23/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 23 complete.

=== Processing Batch 24/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 24 complete.

=== Processing Batch 25/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 25 complete.

=== Processing Batch 26/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 26 complete.

=== Processing Batch 27/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 27 complete.

=== Processing Batch 28/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 28 complete.

=== Processing Batch 29/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 29 complete.

=== Processing Batch 30/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 30 complete.

=== Processing Batch 31/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 31 complete.

=== Processing Batch 32/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 32 complete.

=== Processing Batch 33/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 33 complete.

=== Processing Batch 34/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 34 complete.

=== Processing Batch 35/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 35 complete.

=== Processing Batch 36/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 36 complete.

=== Processing Batch 37/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 37 complete.

=== Processing Batch 38/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 38 complete.

=== Processing Batch 39/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 39 complete.

=== Processing Batch 40/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 40 complete.

=== Processing Batch 41/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 41 complete.

=== Processing Batch 42/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 42 complete.

=== Processing Batch 43/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 43 complete.

=== Processing Batch 44/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 44 complete.

=== Processing Batch 45/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 45 complete.

=== Processing Batch 46/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 46 complete.

=== Processing Batch 47/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 47 complete.

=== Processing Batch 48/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 48 complete.

=== Processing Batch 49/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 49 complete.

=== Processing Batch 50/50 ===
  Processing 100 images (each split between CPU and GPU)
  Batch 50 complete.

All batches finished!

========== PERFORMANCE RESULTS ==========

1. OVERALL EXECUTION TIME
   Total wall-clock time: 3441.17 ms (3.44 seconds)
   Total images processed: 5000

2. CPU DEVICE (processed 5000 images - top 96 rows each)
   Total CPU time:        993.96 ms
   - Transfer IN:         27.10 ms (2.7%)
   - Kernel execution:    846.50 ms (85.2%)
   - Transfer OUT:        120.36 ms (12.1%)

3. GPU DEVICE (processed 5000 images - bottom 144 rows each)
   Total GPU time:        1066.03 ms
   - Transfer IN:         18.97 ms (1.8%)
   - Kernel execution:    461.14 ms (43.3%)
   - Transfer OUT:        585.92 ms (55.0%)

============================
4. DEVICE COMPARISON
   CPU is 1.07x FASTER than GPU
   CPU/GPU time ratio: 0.93

5. WORKLOAD BALANCE
   Workload imbalance: 6.8%
   GPU is the BOTTLENECK (72.07 ms slower)

6. BOTTLENECK IDENTIFICATION
   CPU bottleneck: COMPUTATION (85.2% of time)
   GPU bottleneck: COMMUNICATION (56.7% of time)

7. THROUGHPUT
   Overall throughput: 111.59 Megapixels/sec
   Images per second: 1452.99

=========================================

8. SPLIT-IMAGE STATISTICS
   CPU time per image: 0.199 ms (for 96 rows)
   GPU time per image: 0.213 ms (for 144 rows)
   Combined time per image: 0.688 ms
   Current GPU ratio: 59.7%

9. OPTIMAL RATIO RECOMMENDATION
   CPU: 0.00207 ms/row
   GPU: 0.00148 ms/row
   Recommended GPU ratio: 58.3%
   Run with: ./split_image_blur 0.583
