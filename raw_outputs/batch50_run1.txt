========== SPLIT-IMAGE CONFIGURATION ==========
Input file: ./image_320x240.jpg
Number of images in stream: 5000
Batch size: 50 images
Number of batches: 100
Work-group size: 16x16
GPU ratio: 57.4% (rows to GPU)
Halo size: 1 row(s)
================================================

Original image loaded: 320x240, 3 channels
Size of one image: 230400 bytes (225.00 KB)
Original image converted to interleaved format

Split configuration:
  Split row: 102 (CPU: rows 0-101, GPU: rows 102-239)
  CPU: 103 input rows (inc. halo), 102 output rows
  GPU: 139 input rows (inc. halo), 138 output rows
  CPU input size: 96.56 KB, output size: 95.62 KB
  GPU input size: 130.31 KB, output size: 129.38 KB

Platform 0: rusticl
Platform 1: Portable Computing Language
CPU device: cpu-skylake-avx512-AMD Ryzen AI 7 350 w/ Radeon 860M
GPU device: AMD Radeon 860M Graphics (radeonsi, gfx1152, LLVM 20.1.8, DRM 3.64, 6.16.12-200.fc42.x86_64)

Loading kernel source...
Kernel source loaded (2054 bytes)
Building kernel for CPU...
CPU kernel built successfully
Building kernel for GPU...
GPU kernel built successfully
Kernel objects created

Allocating device buffers...
Device buffers allocated

Setting kernel arguments...
Kernel arguments set

CPU global size: 320 x 112
GPU global size: 320 x 144
Local size: 16 x 16

Starting batch processing of 5000 images in 100 batches...

=== Processing Batch 1/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 1 complete.

=== Processing Batch 2/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 2 complete.

=== Processing Batch 3/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 3 complete.

=== Processing Batch 4/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 4 complete.

=== Processing Batch 5/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 5 complete.

=== Processing Batch 6/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 6 complete.

=== Processing Batch 7/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 7 complete.

=== Processing Batch 8/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 8 complete.

=== Processing Batch 9/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 9 complete.

=== Processing Batch 10/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 10 complete.

=== Processing Batch 11/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 11 complete.

=== Processing Batch 12/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 12 complete.

=== Processing Batch 13/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 13 complete.

=== Processing Batch 14/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 14 complete.

=== Processing Batch 15/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 15 complete.

=== Processing Batch 16/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 16 complete.

=== Processing Batch 17/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 17 complete.

=== Processing Batch 18/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 18 complete.

=== Processing Batch 19/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 19 complete.

=== Processing Batch 20/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 20 complete.

=== Processing Batch 21/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 21 complete.

=== Processing Batch 22/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 22 complete.

=== Processing Batch 23/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 23 complete.

=== Processing Batch 24/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 24 complete.

=== Processing Batch 25/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 25 complete.

=== Processing Batch 26/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 26 complete.

=== Processing Batch 27/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 27 complete.

=== Processing Batch 28/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 28 complete.

=== Processing Batch 29/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 29 complete.

=== Processing Batch 30/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 30 complete.

=== Processing Batch 31/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 31 complete.

=== Processing Batch 32/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 32 complete.

=== Processing Batch 33/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 33 complete.

=== Processing Batch 34/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 34 complete.

=== Processing Batch 35/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 35 complete.

=== Processing Batch 36/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 36 complete.

=== Processing Batch 37/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 37 complete.

=== Processing Batch 38/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 38 complete.

=== Processing Batch 39/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 39 complete.

=== Processing Batch 40/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 40 complete.

=== Processing Batch 41/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 41 complete.

=== Processing Batch 42/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 42 complete.

=== Processing Batch 43/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 43 complete.

=== Processing Batch 44/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 44 complete.

=== Processing Batch 45/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 45 complete.

=== Processing Batch 46/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 46 complete.

=== Processing Batch 47/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 47 complete.

=== Processing Batch 48/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 48 complete.

=== Processing Batch 49/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 49 complete.

=== Processing Batch 50/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 50 complete.

=== Processing Batch 51/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 51 complete.

=== Processing Batch 52/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 52 complete.

=== Processing Batch 53/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 53 complete.

=== Processing Batch 54/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 54 complete.

=== Processing Batch 55/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 55 complete.

=== Processing Batch 56/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 56 complete.

=== Processing Batch 57/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 57 complete.

=== Processing Batch 58/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 58 complete.

=== Processing Batch 59/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 59 complete.

=== Processing Batch 60/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 60 complete.

=== Processing Batch 61/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 61 complete.

=== Processing Batch 62/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 62 complete.

=== Processing Batch 63/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 63 complete.

=== Processing Batch 64/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 64 complete.

=== Processing Batch 65/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 65 complete.

=== Processing Batch 66/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 66 complete.

=== Processing Batch 67/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 67 complete.

=== Processing Batch 68/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 68 complete.

=== Processing Batch 69/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 69 complete.

=== Processing Batch 70/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 70 complete.

=== Processing Batch 71/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 71 complete.

=== Processing Batch 72/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 72 complete.

=== Processing Batch 73/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 73 complete.

=== Processing Batch 74/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 74 complete.

=== Processing Batch 75/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 75 complete.

=== Processing Batch 76/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 76 complete.

=== Processing Batch 77/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 77 complete.

=== Processing Batch 78/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 78 complete.

=== Processing Batch 79/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 79 complete.

=== Processing Batch 80/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 80 complete.

=== Processing Batch 81/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 81 complete.

=== Processing Batch 82/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 82 complete.

=== Processing Batch 83/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 83 complete.

=== Processing Batch 84/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 84 complete.

=== Processing Batch 85/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 85 complete.

=== Processing Batch 86/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 86 complete.

=== Processing Batch 87/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 87 complete.

=== Processing Batch 88/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 88 complete.

=== Processing Batch 89/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 89 complete.

=== Processing Batch 90/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 90 complete.

=== Processing Batch 91/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 91 complete.

=== Processing Batch 92/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 92 complete.

=== Processing Batch 93/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 93 complete.

=== Processing Batch 94/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 94 complete.

=== Processing Batch 95/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 95 complete.

=== Processing Batch 96/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 96 complete.

=== Processing Batch 97/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 97 complete.

=== Processing Batch 98/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 98 complete.

=== Processing Batch 99/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 99 complete.

=== Processing Batch 100/100 ===
  Processing 50 images (each split between CPU and GPU)
  Batch 100 complete.

All batches finished!

========== PERFORMANCE RESULTS ==========

1. OVERALL EXECUTION TIME
   Total wall-clock time: 3187.99 ms (3.19 seconds)
   Total images processed: 5000

2. CPU DEVICE (processed 5000 images - top 102 rows each)
   Total CPU time:        930.45 ms
   - Transfer IN:         26.00 ms (2.8%)
   - Kernel execution:    793.49 ms (85.3%)
   - Transfer OUT:        110.96 ms (11.9%)

3. GPU DEVICE (processed 5000 images - bottom 138 rows each)
   Total GPU time:        902.75 ms
   - Transfer IN:         20.61 ms (2.3%)
   - Kernel execution:    303.85 ms (33.7%)
   - Transfer OUT:        578.29 ms (64.1%)

============================
4. DEVICE COMPARISON
   GPU is 1.03x FASTER than CPU
   CPU/GPU time ratio: 1.03

5. WORKLOAD BALANCE
   Workload imbalance: 3.0%
   CPU is the BOTTLENECK (27.70 ms slower)

6. BOTTLENECK IDENTIFICATION
   CPU bottleneck: COMPUTATION (85.3% of time)
   GPU bottleneck: COMMUNICATION (66.3% of time)

7. THROUGHPUT
   Overall throughput: 120.45 Megapixels/sec
   Images per second: 1568.39

=========================================

8. SPLIT-IMAGE STATISTICS
   CPU time per image: 0.186 ms (for 102 rows)
   GPU time per image: 0.181 ms (for 138 rows)
   Combined time per image: 0.638 ms
   Current GPU ratio: 57.4%

9. OPTIMAL RATIO RECOMMENDATION
   CPU: 0.00182 ms/row
   GPU: 0.00131 ms/row
   Recommended GPU ratio: 58.2%
   Run with: ./split_image_blur 0.582
